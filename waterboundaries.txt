OLD Rename field tool to name columns alike

OLD Merge federalandstatewaters and stateboundaries with QGIS>Vector General>Merge vector layers

OLD Dissolve merged layer with QGIS > Dissolve > specify dissolve field

Use TIGER shapefile that has land+water boundaries



Use GRASS>r.lake on nationwide DEM at original resolution. Use 0.1 lake height and pick start coordinates in the same CRS as DEM and workspace in the ocean. 

#downscale lake output to 500x500m resolution
gdalwarp -overwrite -t_srs ESRI:102004 -of GTiff -tr 500.0 500.0 -tap ./dissolved_500k/7-5-arc-second-ocean.tif ./dissolved_500k/7-5-arc-second-ocean-500m-width-reproject-102004.tif -r cubicspline -multi -co COMPRESS=ZSTD -co PREDICTOR=2 -co NUM_THREADS=ALL_CPUS -wo "NUM_THREADS=ALL_CPUS"

#watch out for -9999 nodata, if -dstnodata is used to set -9999 nodata, the gdalcalc will ignore all points that are in the -9999 nodata input!

#crop lake output by hydro dem
gdalwarp -overwrite -t_srs ESRI:102004 -of GTiff -tr 500.0 500.0 -te -6490500 -1937000 3519500 4780000 -te_srs ESRI:102004 ./dissolved_500k/7-5-arc-second-ocean-500m-width-reproject-102004.tif ./dissolved_500k/7-5-arc-second-ocean-500m-width-reproject-102004-extent-matched.tif -r cubicspline -multi -co COMPRESS=ZSTD -co PREDICTOR=2 -co NUM_THREADS=ALL_CPUS -wo "NUM_THREADS=ALL_CPUS"

Add 1 to locations on hydroraised DEM where lake outputs are >0 and hydroraised is not already >0. Avoids re-raising areas touched by hydro1k/hydrostreams since those areas will already poke above normal dem.

#md test
gdalwarp -overwrite -t_srs ESRI:102004 -of GTiff -tr 500 500 -tap -cutline ./tl_2022_us_state/split_individual/MD.gpkg -crop_to_cutline ./dems/dems-ready-to-cut/7-5-arc-second-merged-500m-width-raised-460.tif ./dems/7-5-arc-second-clipped-500m/MD.tif -r cubicspline -multi -co COMPRESS=ZSTD -co PREDICTOR=2 -wo "NUM_THREADS=val/ALL_CPUS" 
gdalwarp -overwrite -t_srs ESRI:102004 -of GTiff -tr 500 500 -tap -cutline ./tl_2022_us_state/split_individual/MD.gpkg -crop_to_cutline ./dems/dems-ready-to-cut/7-5-arc-second-merged-500m-width-hydro-patched-raised2-400.tif C:/Users/ansonl/development/dem-to-stl-workflow/dems/7-5-arc-second-clipped-500m-hydro-patched/MD-hydro-patched.tif -r cubicspline -multi -co COMPRESS=ZSTD -co PREDICTOR=2 -wo "NUM_THREADS=val/ALL_CPUS" 
#toucheterrain
python ./TouchTerrain_standalone.py ./touch_terrain_configs_500m/MD.json
python ./TouchTerrain_standalone.py ./touch_terrain_configs_500m/MD-no-rivers.json
#libigl
./gp-cli/precompiled/pc/bin/meshboolean.exe ./state_stls_500m/MD-no-rivers/MD-hydro-patched_repaired.STL ./state_stls_500m/MD/MD_repaired.STL minus ./state_stls_500m/MD/MD_rivers.STL